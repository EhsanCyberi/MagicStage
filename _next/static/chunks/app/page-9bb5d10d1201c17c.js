(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{8404:(e,t,l)=>{Promise.resolve().then(l.bind(l,7676)),Promise.resolve().then(l.t.bind(l,9195,23))},7676:(e,t,l)=>{"use strict";l.d(t,{default:()=>r});var a=l(5155),s=l(2115);let i="game_stage",n="game_inventory";function r(){let[e,t]=(0,s.useState)(null),[l,r]=(0,s.useState)(null),[c,o]=(0,s.useState)(null),[d,m]=(0,s.useState)(null),[u,h]=(0,s.useState)(!1);(0,s.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat("/MagicStage","/history.json"));if(!e.ok)throw Error("Failed to load history.json");let l=await e.json();t(l);let a=localStorage.getItem(i),s=localStorage.getItem(n);r(a?Number(a):1),o(s?JSON.parse(s):[]),h(!0)}catch(e){console.error("Error loading game:",e),h(!0)}})()},[]),(0,s.useEffect)(()=>{u&&null!==l&&null!==c&&(localStorage.setItem(i,l),localStorage.setItem(n,JSON.stringify(c)))},[l,c,u]);let g=()=>{r(1),o([]),localStorage.removeItem(i),localStorage.removeItem(n)},v=e=>{if(m(null),e.isDeath){alert(e.deathMessage||"You died."),g();return}if(e.requiredItem){var t;if(!(null!==(t=null==c?void 0:c.includes(e.requiredItem))&&void 0!==t&&t)){e.fallbackStage?r(e.fallbackStage):e.feedback&&m(e.feedback);return}}!e.givesItem||(null==c?void 0:c.includes(e.givesItem))||o(t=>[...t||[],e.givesItem]),r(e.nextStage)};if(!u||null===l||null===c||null===e)return(0,a.jsx)("div",{className:"loading",children:"درحال بارگذاری..."});let f=e.find(e=>e.id===l);return f?(0,a.jsx)("div",{className:"gameContainer",children:(0,a.jsxs)("div",{className:"gameCard",children:[(0,a.jsxs)("h2",{className:"stageTitle",children:["صحنه ",f.id]}),(0,a.jsx)("p",{className:"stageText",children:f.text}),d&&(0,a.jsx)("p",{className:"feedbackMessage",children:d}),(0,a.jsx)("div",{className:"choicesContainer",children:f.choices.map((e,t)=>(0,a.jsx)("button",{onClick:()=>v(e),className:"choiceButton",children:e.text},t))}),(0,a.jsx)("hr",{className:"divider"}),(0,a.jsxs)("div",{className:"inventorySection",children:[(0,a.jsx)("div",{className:"inventoryTitle",children:"دارایی"}),0===c.length?(0,a.jsx)("p",{className:"inventoryEmpty",children:"خالی"}):(0,a.jsx)("ul",{className:"inventoryList",children:c.map(e=>(0,a.jsx)("li",{className:"inventoryItem",children:e},e))})]})]})}):(0,a.jsx)("div",{children:"صحنه یافت نشد"})}},9195:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[450,441,517,358],()=>t(8404)),_N_E=e.O()}]);